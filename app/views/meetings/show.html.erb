<!-- Legislation Options -->
<div class="row">
  <div class="right button-bar">
    <!-- Action Buttons -->
    <ul class="button-group">
      <li><%= link_to 'Agenda', agenda_path(@meeting), class:'tiny button' %></li>
      <% if @meeting.has_happened? %>
          <li><%= link_to 'Minutes', minutes_path(@meeting), class: 'tiny button'%></li>
      <% end %>
      <li><%= link_to 'All', meetings_path, class:'tiny button' %></li>
    </ul>
    <ul class="admin button-group">
      <li><%= link_to 'Edit', edit_meeting_path(@meeting), class:'tiny button' %></li>
      <li><%= link_to('Delete', meeting_path,
                      method: "delete", class: 'tiny alert button',
                      data: { confirm: 'Are you sure you want to delete this?'}) %></li>
    </ul>
  </div>
</div>


<div class="row">

  <!--Title-->
  <h2>
    <%= @meeting.organization.name %> Meeting
    <small><%= @meeting.date.to_formatted_s(:long_ordinal) %></small>
  </h2>

  <!--Admin-->
  <div class="admin panel">
    <h3>Meeting Admin:</h3>
    <ul>
      <li><%= link_to 'Start Meeting', start_meeting_path(@meeting) %></li>
      <% agenda_option = @meeting.approved_agenda? ? 'Unapprove Agenda' : 'Approve Agenda' %>
      <li><%= link_to agenda_option, toggle_agenda_path, remote: true, id:'agenda-toggle' %></li>

      <% if @meeting.has_happened? %>
          <% minutes_option = @meeting.approved_minutes? ? 'Unapprove Minutes' : 'Approve Minutes' %>
          <li><%= link_to minutes_option, toggle_minutes_path, remote: true, id:'minutes-toggle' %></li>
      <% end %>
    </ul>
  </div>


  <!--Details-->
  <h3>Meeting Details</h3>
  <dl>
    <dt>Date:</dt>
    <dd><%= @meeting.date.to_formatted_s(:long_ordinal) %></dd>
    <dt>Time:</dt>
    <dd><%= @meeting.time.to_formatted_s(:time) %></dd>
    <dt>Location:</dt>
    <dd><%= @meeting.location || 'No location specified' %><br />
      <% if @meeting.location %>
          <iframe width="400" height="200" frameborder="0" style="border:0"
                  src="https://www.google.com/maps/embed/v1/place?q=<%= @meeting.location %>&key=<%= ENV['GOOGLE_API'] %>"></iframe>
      <% end %>
    </dd>
  </dl>


  <!--Downloads-->
  <h3>Downloads</h3>
  <ul>
    <li><%= link_to 'Agenda', agenda_path(@meeting) %>
      (<%= link_to 'pdf', agenda_path(@meeting, format: 'pdf') %>)</li>

    <% if @meeting.has_happened? %>
        <li><%= link_to 'Minutes', minutes_path(@meeting) %>
          (<%= link_to 'pdf', minutes_path(@meeting, format: 'pdf') %>)</li>
    <% else %>
        <li><i>Minutes unavailable (meeting has not yet occured)</i></li>
    <% end %>
  </ul>

  <!--Stream Link-->
  <% if @meeting.is_started? %>
      <%= link_to 'Go To Meeting Stream', 'http://www.ustream.tv/channel/troycitycouncil',
                  class: 'large button expand',
                  target:'_blank' %>
  <% else %>
      <%= link_to 'Meeting Stream Not Yet Available', '#',
                  class: 'large disabled button expand' %>
  <% end %>


  <!--Legislation Listing-->
  <h3>Listing Associated Legislation</h3>

  <ul>
    <% @meeting.grouped_legislations.each do |legislation_type, legislations| %>
        <h4><%= pluralize legislations.count, legislation_type %></h4>
        <% legislations.each do |legislation| %>
            <li>
              <%= short_title legislation %> |
              <%= link_to 'html', legislation %> |
              <%= link_to 'pdf', legislation_path(legislation, format: 'pdf') %>
            </li>
        <% end %>
    <% end %>
  </ul>

</div>