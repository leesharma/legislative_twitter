<div class="row">
  <div class="small-12 columns">
    <h2><%= @legislation.title %><br />
      <small><%= @legislation.created_at_time %></small>
    </h2>

    <div class="panel">
      <%= @legislation.body.html_safe %>
      <!--todo: how does this impact security?-->
    </div>

    <%= link_to 'Edit', edit_legislation_path(@legislation), class:'small button' %>
    <%= link_to 'Back', legislations_path, class:'small button' %>
    <%= link_to('Archive', legislation_path,
                  method: "delete", remote: true, class: 'small alert button',
                  data: { confirm: 'Are you sure you want to archive this?'}) %>

    <br /><hr />
    <!-- todo: ugly solution -->
    <p>
    <table width="100%" role="grid" summary="All changes (creates, updates, and destroys) to the legislation in question, including the attributes changed, the time changed, and links to a detailed diff and rollback button.">
      <caption>Legislation Changelog</caption>
      <thead>
        <tr>
          <th>Action</th>
          <th>Changed Attributes</th>
          <th>Time</th>
          <th>&Delta;</th>
          <th>Rollback</th>
        </tr>
      </thead>
      <tbody>
      <% @versions.each do |version| %>
        <tr>
          <td><%= version.event %></td>
          <td><%= @legislation.list_changed_attributes version %></td>
          <td><%= version.created_at.strftime("%-l:%M%P on %m/%d/%y") %></td>
          <td><a href="#" data-no-turbolink data-reveal-id="diffModal<%=version.id%>">View Diff</a></td>
          <td><%= link_to 'Rollback', revert_version_path(id: version.id),
                          method: :post %></td>
          <%= render 'application/diff_modal', version: version, legislation: @legislation %>
        </tr>
      <% end %>
      </tbody>
    </table>
    </p>
  </div>
</div>
